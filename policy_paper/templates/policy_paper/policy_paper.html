{% extends "post_page.html" %}

{% load wagtailcore_tags %}
{% load wagtailcore_tags wagtailimages_tags %}
{% load utilities %}

{% block body_class %}template-policypaper{% endblock %}

{% block post-header %}
	{% if page.publication_cover_image %}
		<div class="book-container">
			<div class="book">
			{% image page.publication_cover_image min-95x155 as cover_image %}
				<img src="{{ cover_image.url }}" />
			</div>
		</div>
	{% endif %}
	<div class="post-header-container">
		<div class="post-header">
			<div class="post-header__text">
		    	<h1 class="post-header__text__heading">{{ page.title }}</h1>
		    	{% if page.subheading %}
		    		<h2 class="post-header__text__subheading">{{ page.subheading }}</h2>
		    	{% endif %}
			</div>
		</div>
	</div>
	
{% endblock %}

{% block post-body %}

    <div class="post-body with-dropcap">
	    {% for block in self.body %}
	    	<div class="block-{{ block.block_type }}">
		       {% if block.block_type == 'image' %}
	            	{{ block }}
	            	{% if block.value.caption or block.value.source %}
	            		<div class="caption">{{ block.value.caption }} {% if block.value.source %}({{ block.value.source }}){% endif %}</div>
	            	{% endif %}
		        {% else %}
		            {{ block }}
		        {% endif %}
	   		</div>
	    {% endfor %}
	</div>

	{% if page.attachment %}
		<div class="post-attachment">
			<div class="post-attachment__image"></div>
			<div class="post-attachment__text">
				{% with page.attachment|length as num_attachments %}
					<h3>{% pluralize num_attachments "ATTACHMENT" %}</h3>
					{% for block in page.attachment %}
						<div class="post-attachment__text__item"><a href='{{ block.value.file.url }}'>{{ block.value.title }}</a></div>
					{% endfor %}
				{% endwith %}
			</div>
		</div>
	{% endif %}

{% endblock %}
