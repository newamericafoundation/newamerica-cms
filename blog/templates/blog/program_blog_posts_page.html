{% extends "program_base.html" %}

{% load wagtailcore_tags %}
{% load wagtailimages_tags %}
{% load utilities %}

{% block body_class %}template-programblogpostspage{% endblock %}

{% block content %}
	<div class="post-header-container">
		<div class="post-header">
			<div class="post-header__text">
		    	<h1 class="post-header__text__heading">{{ page.title }}</h1>
		    	{% if page.subheading %}
		    		<h2 class="post-header__text__subheading">{{ page.subheading | richtext }}</h2>
		    	{% endif %}
			</div>
		</div>
	</div>
	
	{% with post=all_posts|first %}
		<div class='blog-lead-story'>
			<div class='hero-grid has-1-children'>
				<div class='hero-grid__main'>
					<div class='hero-grid__element'>
					<a href="{{ post.url }}">
						<div class='hero-grid__element__wrapper'>
						{% image post.story_image min-1100x500 as post_image %}
							<div class='hero-grid__element__background' style='background-image: url({{ post_image.url }})'></div>
							<div class='hero-grid__element__overlay'></div>
							<div class='hero-grid__element__text-bar'>
								{% if post.post_subprogram.all %}
									<h5 class="hero-grid__element__text-bar__program">
									{% for subprogram in post.post_subprogram.all %}
										<a href="{{ subprogram.url }}"> {{ subprogram | upper }}</a>{% list_separator forloop.revcounter0 %}
									{% endfor %}
									</h5>
								{% endif %}
								<h1 class='hero-grid__element__text-bar__heading'>{{ post.title }}</h1>
								{% if post.authors.all %}
									<p class='hero-grid__element__text-bar__subheading' href="{{ post.url }}">{% generate_byline post.content_type post.authors.all %}</p>
								{% endif %}
								<h5 class= "hero-grid__element__text-bar__date">{{ post.date }} </h5>
								<p class= "hero-grid__element__text-bar__excerpt">{{ post.story_excerpt }}</p>
							</div>
						</div>
					</a>
					</div>
				</div>
			</div>
		</div>
	{% endwith %}


	<div class="content-grid__entries blog">
		
		{% for post in all_posts %}
			<div class="content-entry blog">
				{% if post.story_image %}
					{% image post.story_image min-650x200 as post_image %}

					<a href="{{ post.url }}">
						<div class="content-entry__image-container" style="background-image: url('{{post_image.url}}') ">
						</div>
					</a>
				<div class="content-entry__text-container has-image">
				
				{% else %}
				<div class="content-entry__text-container">
				{% endif %}
					<div class="content-entry__text">
						{% if post.post_subprogram.all %}
							<h5 class="content-entry__text__program">
							{% for subprogram in post.post_subprogram.all %}
								<a href="{{ subprogram.url }}"> {{ subprogram | upper }}</a>{% list_separator forloop.revcounter0 %}
							{% endfor %}
							</h5>
						{% endif %}
						<h5 class= "content-entry__text__title"><a href="{{ post.url }}">{{ post.title }}</a></h5>

						{% if post.authors.all %}
							<h5 class= "content-entry__text__author">{% generate_byline post.content_type post.authors.all %}</h5>
						{% endif %}
						<h5 class= "content-entry__text__date-time">{% generate_dateline post %}</h5>
						<p class= "content-entry__text__excerpt">{{ post.story_excerpt }}</p>
						
					</div>
				</div>
			</div>
			<hr>
		{% endfor %}
	</div>

	<div class="content-grid__footer">
		<div class="pagination">
			{% if all_posts.has_previous %}
				<a class="pagination__arrow" href="?page={{ all_posts.previous_page_number }}">
					{% include 'ui_elements/svg/arrow-left.html' %}
				</a>
			{% endif %}

			<span>Page</span>
			<form class="pagination__form" action="?page=value" method="get">
				<input class="pagination__input" type="text" placeholder="{{ all_posts.number }}" name="page">
			</form>

			<span>of</span>
			<a href="?page={{ all_posts.paginator.num_pages|get_range|last }}">{{ all_posts.paginator.num_pages|get_range|last }}</a>

			{% if all_posts.has_next %}
		    	<a class="pagination__arrow" href="?page={{ all_posts.next_page_number }}">
		    		{% include 'ui_elements/svg/arrow-right.html' %}
				</a>
			{% endif %}
		</div>
	</div>
{% endblock %}