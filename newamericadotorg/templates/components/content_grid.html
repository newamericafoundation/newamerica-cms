{% load wagtailcore_tags wagtailimages_tags utilities %}

<div class="content-grid__entries blog">
  {% for post in all_content %}
    <div class="content-entry blog">
      {% if post.story_image %}
        {% image post.story_image min-650x200 as post_image %}

      <a href="{{ post.url }}">
        <div class="content-entry__image-container" style="background-image: url('{{post_image.url}}')"></div>
      </a>
      <div class="content-entry__text-container has-image">

      {% else %}
        <div class="content-entry__text-container">
      {% endif %}
        <div class="content-entry__text">
          {% if post.post_subprogram.all %}
            <h5 class="content-entry__text__program">
            {% for subprogram in post.post_subprogram.all %}
              <a href="{{ subprogram.url }}"> {{ subprogram | upper }}</a>{% list_separator forloop.revcounter0 %}
            {% endfor %}
            </h5>
          {% endif %}
          <h5 class= "content-entry__text__title"><a href="{{ post.url }}">{{ post.title }}</a></h5>

          {% if post.authors.all %}
            <h5 class= "content-entry__text__author">{% generate_byline post.content_type post.authors.all %}</h5>
          {% endif %}
          <h5 class= "content-entry__text__date-time">{% generate_dateline post %}</h5>
          {% if post.story_excerpt %}
            <p class= "content-entry__text__excerpt">{{ post.story_excerpt }}</p>
          {% endif %}

        </div>
      </div>
    </div>
    <hr/>
  {% endfor %}
</div>
