{% load wagtailimages_tags %}

{% if value.image %}
  {% image value.image min-800x800 as img %}
  {% image value.image original as img_original %}
{% else %}
  {% image value min-800x800 as img %}
  {% image value original as img_original %}
{% endif %}

<div class="block-inline_image__wrapper {% firstof value.align 'no-alignment' %}"
  style="{% if value.width and value.width != 'initial' %}width:{{value.width}};{% endif %}">
  {% if value.open_image_on_click %}
    <a href={{ img_original.url }} target='_blank' >
      <img {{ img.attrs }}/>
    </a>
  {% else %}
    <img {{ img.attrs }}/>
  {% endif %}
  {% if value.caption or value.source or value.image.caption or value.image.source %}
    <div class="caption">
      {% firstof value.caption value.image.caption %}
      {% if value.source or value.image.source %}
        ({% firstof value.source value.image.source %})
      {% endif %}
    </div>
  {% endif %}
</div>
